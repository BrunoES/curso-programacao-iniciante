<html>
    <head>
        <title></title>
        <script src="https://cdn.jsdelivr.net/npm/axios/dist/axios.min.js"></script>
        <script type="text/javascript">

            function consultaCarros() {
                var resultado;

                axios({
                    method: 'get',
                    url: 'http://localhost:8080/carros',
                    responseType: 'json'
                })
                .then(function (response) {
                    response.data.forEach(element => {
                        populaTabela(element);
                    });
                });
            }

            // Fazer antes assim, depois explicar a melhor forma abaixo
            /*
            function populaTabela(element) {
                if (!document.getElementsByTagName) return;
                tabBody=document.getElementById("tabela_carros");
                row=document.createElement("tr");
                
                idCarroCell = document.createElement("td");
                placaCell = document.createElement("td");
                modeloCell = document.createElement("td");
                marcaCell = document.createElement("td");
                corCell = document.createElement("td");
                anoCell = document.createElement("td");
                ativoCell = document.createElement("td");

                idCarroNode=document.createTextNode(element.id_carro);
                placaNode=document.createTextNode(element.placa);
                modeloNode=document.createTextNode(element.nome_modelo);
                marcaNode=document.createTextNode(element.nome_marca);
                corNode=document.createTextNode(element.cor);
                anoNode=document.createTextNode(element.ano_fabricacao);
                ativoNode=document.createTextNode(element.ativo);

                idCarroCell.appendChild(idCarroNode);
                placaCell.appendChild(placaNode);
                modeloCell.appendChild(modeloNode);
                marcaCell.appendChild(marcaNode);
                corCell.appendChild(corNode);
                anoCell.appendChild(anoNode);
                ativoCell.appendChild(ativoNode);

                row.appendChild(idCarroCell);
                row.appendChild(placaCell);
                row.appendChild(modeloCell);
                row.appendChild(marcaCell);
                row.appendChild(corCell);
                row.appendChild(anoCell);
                row.appendChild(ativoCell);

                tabBody.appendChild(row);
            }
            */

            function populaTabela(element) {
                tabBody=document.getElementById("tabela_carros");
                row=document.createElement("tr");

                // Populando tabela
                Object.values(element).forEach(value => {
                    cell = document.createElement("td");
                    node=document.createTextNode(value);
                    cell.appendChild(node);
                    row.appendChild(cell);
                });

                // Criando link a href para cadastro
                var link = document.createElement("a");
                link.setAttribute("href", `./cadastro.html?idCarro=${element.id_carro}`)
                node=document.createTextNode("Editar");
                link.appendChild(node);
                row.appendChild(link);

                tabBody.appendChild(row);
            }

            consultaCarros();
        </script>
    </head>
    <body>
        <h1>CRUD Carros</h1>
        <table class="table" id="tabela_carros">
            <thead>
                <tr>
                <th scope="col">ID</th>
                <th scope="col">Placa</th>
                <th scope="col">Nome Modelo</th>
                <th scope="col">Nome Marca</th>
                <th scope="col">Cor</th>
                <th scope="col">Ano Fabricação</th>
                <th scope="col">Ativo</th>
                <th scope="col">#</th>
                </tr>
            </thead>
            <tbody>
            </tbody>
        </table>
    </body>
</html>
